{"ast":null,"code":"import _regeneratorRuntime from\"/Users/jacqueline.floyd/Desktop/Course Work/Strangers Things 2/strangers-things/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/jacqueline.floyd/Desktop/Course Work/Strangers Things 2/strangers-things/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/jacqueline.floyd/Desktop/Course Work/Strangers Things 2/strangers-things/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from'react';import{BrowserRouter,Route,Link}from'react-router-dom';import{AddNewPost}from'./AddNewPost';import{fetchPosts}from'../../api/APIcalls';import{MessageForm}from'./SendMessageForm';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var RenderPosts=function RenderPosts(_ref){var token=_ref.token,APIURL=_ref.APIURL,username=_ref.username;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),posts=_useState2[0],setPosts=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),searchString=_useState4[0],setSearchString=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),message=_useState6[0],setMessage=_useState6[1];function postMatches(post,searchString){var location=post.location.toLowerCase();var description=post.description.toLowerCase();var title=post.title.toLowerCase();var lowercaseString=searchString.toLowerCase();if(title.includes(lowercaseString)||description.includes(lowercaseString)||location.includes(lowercaseString)){return true;}}var filteredPosts=posts.filter(function(post){return postMatches(post,searchString);});var postsToDisplay=searchString.length?filteredPosts:posts;function fetchAllPosts(){return _fetchAllPosts.apply(this,arguments);}//still causing constant rendering?\nfunction _fetchAllPosts(){_fetchAllPosts=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return fetchPosts().then(function(results){setPosts(results);});case 3:_context2.next=8;break;case 5:_context2.prev=5;_context2.t0=_context2[\"catch\"](0);console.error(_context2.t0);case 8:case\"end\":return _context2.stop();}}},_callee2,null,[[0,5]]);}));return _fetchAllPosts.apply(this,arguments);}useEffect(function(){fetchAllPosts();},[postsToDisplay]);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"form\",{id:\"searchForm\",children:[/*#__PURE__*/_jsx(\"label\",{id:\"searchLabel\",children:\"Search Posts\"}),/*#__PURE__*/_jsx(\"input\",{id:\"searchInput\",type:\"text\",placeholder:\"enter searchwords...\",autoComplete:\"off\",value:searchString,onChange:/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e){return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setSearchString(e.target.value);case 1:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref2.apply(this,arguments);};}()}),/*#__PURE__*/_jsx(\"button\",{children:\"Search\"})]}),token?/*#__PURE__*/_jsxs(BrowserRouter,{children:[/*#__PURE__*/_jsx(\"div\",{id:\"buttondiv\",children:/*#__PURE__*/_jsx(\"button\",{className:\"button\",id:\"addButton\",children:/*#__PURE__*/_jsx(Link,{className:\"myPostsLinks\",to:\"/newpost\",children:\"Create New Post\"})})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Route,{path:\"/newpost\",children:/*#__PURE__*/_jsx(AddNewPost,{token:token})})})]}):'']}),/*#__PURE__*/_jsx(\"div\",{id:\"posts\",children:postsToDisplay.map(function(post,index){return/*#__PURE__*/_jsxs(\"div\",{className:\"post\",children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"boxTitle\",children:[\" \",post.title]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Username:\"}),\" \",post.author.username]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Location:\"}),\" \",post.location]}),/*#__PURE__*/_jsx(\"p\",{children:post.description}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\" Price\"}),\": \",post.price]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"Will Deliver: \"}),\" \",post.willDeliver?/*#__PURE__*/_jsx(\"span\",{children:\"No\"}):/*#__PURE__*/_jsx(\"span\",{children:\"Yes\"})]}),token&&post.author.username!==username?/*#__PURE__*/_jsxs(BrowserRouter,{children:[/*#__PURE__*/_jsx(\"button\",{className:\"button\",id:\"messageButton\",children:/*#__PURE__*/_jsx(Link,{className:\"myPostsLinks\",to:\"/message\",children:\"Respond to Author\"})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Route,{path:\"/message\",children:/*#__PURE__*/_jsx(MessageForm,{APIURL:APIURL,post_id:post._id,token:token,message:message,setMessage:setMessage})})})]}):'']},index);})})]});};export{RenderPosts};","map":{"version":3,"names":["React","useState","useEffect","BrowserRouter","Route","Link","AddNewPost","fetchPosts","MessageForm","RenderPosts","token","APIURL","username","posts","setPosts","searchString","setSearchString","message","setMessage","postMatches","post","location","toLowerCase","description","title","lowercaseString","includes","filteredPosts","filter","postsToDisplay","length","fetchAllPosts","then","results","console","error","e","target","value","map","index","author","price","willDeliver","_id"],"sources":["/Users/jacqueline.floyd/Desktop/Course Work/Strangers Things 2/strangers-things/src/components/HeadersComponents/RenderPosts.js"],"sourcesContent":["import React, {useState, useEffect} from 'react';\nimport { BrowserRouter, Route, Link } from 'react-router-dom';\nimport { AddNewPost } from './AddNewPost';\nimport { fetchPosts } from '../../api/APIcalls';\nimport { MessageForm } from './SendMessageForm';\n\nconst RenderPosts = ({token, APIURL, username}) => { \n \n\n \n  const [posts, setPosts] = useState ([]);\n  const [searchString, setSearchString] = useState (\"\");\n  const [message, setMessage] = useState('')\n\n  function postMatches(post, searchString) {\n\n      let location=post.location.toLowerCase();\n      let description=post.description.toLowerCase();\n      let title=post.title.toLowerCase();\n      let lowercaseString=searchString.toLowerCase();\n\n      if (title.includes(lowercaseString) || description.includes(lowercaseString) || location.includes(lowercaseString)) {\n        return true\n      }\n    }\n  \n  const filteredPosts = posts.filter(post => postMatches(post, searchString));\n  const postsToDisplay = searchString.length ? filteredPosts : posts;\n  \n  async function fetchAllPosts() {\n    try {\n      await fetchPosts().then((results) => {setPosts(results)});\n      \n    } catch (error) {\n      console.error(error);\n    }}\n\n    //still causing constant rendering?\n  useEffect(()=>{\n    fetchAllPosts ();\n  }, [postsToDisplay]);\n\nreturn <>\n        <div>\n          <form id='searchForm'>\n            <label id='searchLabel'>Search Posts</label>\n            <input id='searchInput' type=\"text\" placeholder=\"enter searchwords...\" autoComplete=\"off\" value={searchString} \n              onChange={async (e) => {\n                  setSearchString(e.target.value);\n            }}>\n            </input>\n            <button>Search</button>\n          </form>\n\n          {token ?\n          <BrowserRouter>\n          <div id='buttondiv'>\n            <button className='button' id='addButton' >\n              <Link className='myPostsLinks' to=\"/newpost\">Create New Post</Link>\n            </button>\n          </div>\n\n            <div>\n              <Route path=\"/newpost\">\n                <AddNewPost token={token}/>\n              </Route>\n            </div>\n          </BrowserRouter>  : ''}\n        </div>\n\n        <div id=\"posts\">{postsToDisplay.map((post, index)=> {\n\n                return <div className=\"post\" key={index}> \n                            <h2 className='boxTitle'> {post.title}</h2>\n                            <p><b>Username:</b> {post.author.username}</p>\n                            <p><b>Location:</b> {post.location}</p>\n                            <p>{post.description}</p>\n                            <p><b> Price</b>: {post.price}</p>\n                            <p><b>Will Deliver: </b> {post.willDeliver ? <span>No</span>:<span>Yes</span>}</p>\n                            {(token && (post.author.username !== username)) ? \n                            <BrowserRouter>\n                               <button className='button' id='messageButton' >\n                                    <Link className='myPostsLinks' to='/message'>Respond to Author</Link>\n                                </button>\n                                <div>\n                                    <Route path='/message'>\n                                      <MessageForm APIURL={APIURL} post_id={post._id} token={token} message={message} setMessage={setMessage}/>\n                                    </Route> \n                                </div>\n                            </BrowserRouter> : '' }\n                      </div>\n        })}\n        </div>\n      </>\n}\n\nexport {RenderPosts}"],"mappings":"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"},"metadata":{},"sourceType":"module"}